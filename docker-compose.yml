services:
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "${FRONTEND_PORT}:${FRONTEND_PORT}"
    restart: always
    networks:
      - app
    environment:
      VITE_API_URL: /api
      VITE_API_VERSION: v0.0.2
      VITE_API_VERSION_NEW: v1

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "${BACKEND_PORT}:${BACKEND_PORT}"
    restart: always
    networks:
      - app
    environment:
      DATABASE_NAME: "${DB_NAME}"
      DATABASE_USER: "${DB_USER}"
      DATABASE_PASSWORD: "${DB_PASSWORD}"
      DATABASE_HOST: 'postgres'
      DATABASE_PORT: "${DB_PORT}"
      POSTGRES_POOL_MINSIZE: '10'
      POSTGRES_POOL_MAXSIZE: '50'
      SERVER_HOST: '0.0.0.0'
      SERVER_PORT: "${BACKEND_PORT}"
      TIMEZONE: 'Europe/Moscow'
      mail_username: "${MAIL_USERNAME}"
      mail_password: "${MAIL_PASSWORD}"
      mail_from: "${MAIL_FROM}"
      mail_port: "${MAIL_PORT}"
      mail_server: "${MAIL_SERVER}"
      mail_ssl_tls: True
      mail_starttls: False
      use_credentials: True
      validate_certs: True
      
networks:
  app:
